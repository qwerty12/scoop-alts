{
    "version": "202211-3",
    "description": "Firmware for Virtual Machines (x86_64, i686)",
    "homepage": "https://github.com/tianocore/tianocore.github.io/wiki/OVMF",
    "license": "BSD-2-Clause-Patent,MIT",
    "suggest": {
        "qemu": "qemu"
    },
    "url": "https://archlinux.org/packages/testing/any/edk2-ovmf/download/#/edk2-ovmf-202211-3-any.pkg.tar.zst",
    "hash": "ea8924cbcbac1a43103c6a2d57ff3c37afb696d7c82b58bf6d3a5488756a1b82",
    "extract_dir": "usr\\share",
    "post_install": "Remove-Item \"$dir\\ovmf\", \"$dir\\usr\"",
    "checkver": {
        "script": [
            "ForEach ($repo in @('testing', 'extra')) {",
            "$baseurl = 'https://archlinux.org/packages/{0}/any/edk2-ovmf' -f $repo",
            "try {",
            "$cont = Invoke-RestMethod -UseBasicParsing -Method Get -Headers @{'Accept-Encoding'='gzip'} -MaximumRedirection 0 -Uri ($baseurl + '/json/')",
            "} catch {",
            "if ($_.Exception.Response.StatusCode.value__ -eq 404) {",
            "continue",
            "}",
            "throw",
            "}",
            "break",
            "}",
            "$pkgver = $cont.pkgver",
            "$pkgrel = $cont.pkgrel",
            "$epoch = If ($cont.epoch -gt 0) {[string]$cont.epoch + '+'} else {''}",
            "$filename = $cont.filename",
            "Write-Output ('baseurl:\"' + $baseurl + '\"') ('pkgver:\"' + $pkgver + '\"') ('pkgrel:\"' + $pkgrel + '\"') ('epoch:\"' + $epoch + '\"') ('filename:\"' + $filename + '\"')"
        ],
        "regex": "baseurl:\"https://(?<baseurl>.*)\"\\spkgver:\"(?<pkgver>\\d+)\"\\spkgrel:\"(?<pkgrel>\\d+)\"\\sepoch:\"(?<epoch>\\d*?\\+?)\"\\sfilename:\"(?<filename>[\\.\\d\\w-]+)\"",
        "replace": "${epoch}${pkgver}-${pkgrel}"
    },
    "autoupdate": {
        "url": "https://$matchBaseurl/download/#/$matchFilename"
    }
}
